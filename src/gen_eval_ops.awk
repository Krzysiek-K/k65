
{
	gsub(/[\r\n]/,"");
}


!init{
	print "// THIS FILE IS AUTOGENERATED - Do NOT MODIFY" >OUT;
	init=1;

	wiki="doc/wiki-eval-funcs.txt"
	nfn=0
}

/case[ \t]+[0-9]+:/{
	h=$0;
	sub(/^.*\/\/[ \t]*/,"",h);
	sub(/[ \t].*$/,"",h);
	n=$0;
	sub(/.*case[ \t]*/,"",n);
	sub(/:.*$/,"",n);
	printf("{ %3d, %-12s },\n",n,"\"" h "\"") >OUT;
}

/case[ \t]+[0-9]+:[ \t]*\/\/[ \t]*!\.*[a-z]/{
	h=$0;
	sub(/^.*\/\/[ \t]*!\.*/,"",h);
	sub(/[ \t].*$/,"",h);
	a=$0
	sub(/^[^(]*\(/,"(",a);
	sub(/\).*$/,")",a);
	gsub(/[ \t]*/,"",a);
	gsub(/\(/,"( ''",a);
	gsub(/\)/,"'' )",a);
	gsub(/,/,"'', ''",a);
	sub(/'''' /,"",a);
	c=$0
	sub(/^[^)]*\)/,"",c);
	sub(/^[ \t]*/,"",c);
	sub(/[ \t]*$/,"",c);

	fns[nfn++] = "|" h a "\n|" c "\n|-"
}

END{
	n = asort(fns);
	for(i=1;i<=n;i++)
		print fns[i] > wiki;
}
